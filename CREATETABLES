CREATE TABLE CUSTOMER_INFO
(
    customer_id     VARCHAR(50)     NOT NULL PRIMARY KEY, -- ID HAS LETTERS
    zipcode         INT, -- theres 8662 distinct zipcodes
    employment      VARCHAR(250),
    education       VARCHAR(250)
)
GO

INSERT INTO CUSTOMER_INFO
    SELECT customer_id, zipcode, employment, education
    FROM INPUT_DATA

SELECT *FROM CUSTOMER_INFO
-- A state can have various cities

CREATE TABLE STATE_CITY(
    cstmr_state VARCHAR(5)      NOT NULL,
    cstmr_city  VARCHAR(50),

    -- needed as state can have more than one city
    CONSTRAINT PK_State_City PRIMARY KEY (cstmr_state, cstmr_city)
)
GO

-- we cannot insert state or city twice 
-- so we have to make a constraint and only get the unique values?

INSERT INTO STATE_CITY
    SELECT DISTINCT cstmr_state, city FROM INPUT_DATA

-- SELECT *FROM STATE_CITY

CREATE TABLE CITY_ZIPCODE(
    cstmr_city      VARCHAR(50),
    cstmr_zipcode   INT

-- needed as city can have more than one zipcode
    CONSTRAINT PK_City_Zipcode PRIMARY KEY (cstmr_city, cstmr_zipcode)
)
GO

INSERT INTO CITY_ZIPCODE
    SELECT DISTINCT city, zipcode FROM INPUT_DATA

select *FROM CITY_ZIPCODE 

-- with persons zipcode we can findout their COUNTY
-- im assuming people will have the same zipcode with different counties?
CREATE TABLE ZIPCODE_COUNTY(
    cstmr_zipcode           INT     ,      -- 8662 unique codes
    county                  VARCHAR(50),   -- 1662 distinct counties
    zipcode_population      INT,
    cstmr_area              VARCHAR(20)
    -- people will share zipcodesd
    CONSTRAINT PK_Zipcode_County PRIMARY KEY (cstmr_zipcode, county)
)

-- 6001 distint populations
select distinct state_population from INPUT_DATA

-- so our total rows should be 8662

INSERT INTO ZIPCODE_COUNTY
    -- select the data from the columns inside input data
    SELECT DISTINCT zipcode,county, state_population, area
    FROM INPUT_DATA

select * from ZIPCODE_COUNTY